'use strict';

const fs = require('fs');

const date = () => new Date().toLocaleString().split('.')[0].replace('T', ' ');

const rand = arr => arr[Math.floor(Math.random() * arr.length)];

const promisify = require('./modules/promisify');

const capitalizeFirstLetter = str =>
	str[0].toUpperCase() + str.slice(1);

const caps = str => {
	str = str.split('');
	for (let i = 0; i < str.length; i++)
		str[i] = Math.random() < 0.5
			? str[i].toLowerCase()
			: str[i].toUpperCase();
	return str.join('');
};

const stat = promisify(fs.stat);
const deleteFile = promisify(fs.unlink);
const appendFile = promisify(fs.appendFile);
const size = file =>
	stat(file).then(stats => stats.size / 1024).catch(() => 0);

const exists = file => stat(file)
	.then(() => true)
	.catch(() => false);

const commandArgs = msg => {
	let shitfuck = msg;
	shitfuck = shitfuck.text.split(/\s+/);
	shitfuck.shift();
	return shitfuck;
};

const commandText = msg => {
	let text = commandArgs(msg);
	text = text.join(' ');
	return text;
};

const id = msg => msg.from.id;


// shamelessly stolen from NightBot
const niggerify = (str, limit) => {
	emoji=['😂','😂','😂','😂','😂','😂','😂','😂','👌','✌','💞','👍','👌','💯','👌','💯','👌','💯','👌','💯','🎶','👀','😂','👓','👏','👐','🍕','💥','🍴','💦','💦','💦','💦','🍑','🍆','😩','😏','👉👌','👀','👀','👀','👀','👅','👅','😩','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','😀','😃','😄','😁','😆','😅','😂','🤣','☺','😌','😇','🙂','🙃','😉','😌','😍','😘','😗','😙','😚','😋','😜','😝','😛','🤑','🤗','🤓','😎','🤡','🤠','😏','😒','😞','😔','😟','😕','🙁','☹','😣','😖','😫','😩','😤','😠','😡','😶','😐','😑','😯','😦','😧','😮','😲','😵','😳','😱','😨','😰','😢','😥','🤤','😭','😓','😪','😴','🙄','🤔','🤥','😬','🤐','🤢','🤧','😷','🤒','🤕','😈','👿','👹','👺','💩','👻','💀','☠','👽','👾','🤖','🎃','😺','😸','😹','😻','😼','😽','🙀','😿','😾','👐','🙌','👏','🤝','👍','👎','👊','✊','🤛','🤜','🤞','✌','🤘','👌','👈','👉','👆','👇','☝','✋','💪','🖕','✍','🤳','💅','💍','💄','💋','👄','👅','👂','👃','👣','👁','👀','🗣','👤','👥','👶','👦','👧','👨','👩','👱','🏻','‍♀','👱','👴','👵','👲','👳','‍♀','👳','👮','‍♀','👮','👷','‍♀','👷','💂','‍♀','🕵','♀','🕵','👩','‍⚕','👨','‍⚕','👩','🏿','🌾','👨','🌾','👩','🍳','👨','🍳','👩','🎓','👨','🎓','👩','🎤','👨','🎤','👩','🏫','👨','🏫','👩','🏭','👨','🏭','👩','💻','👨','💻','👩','💼','👨','💼','👩','🔧','👨','🔧','👩','🔬','👨','🔬','👩','🎨','👨','🎨','👩','🚒','👨','🚒','👨','‍✈','👩','‍✈','👩','🚀','😂','😂','😂','😂','😂','😂','😂','😂','👌','✌','💞','👍','👌','💯','👌','💯','👌','💯','👌','💯','🎶','👀','😂','👓','👏','👐','🍕','💥','🍴','💦','💦','💦','💦','🍑','🍆','😩','😏','👉👌','👀','👀','👀','👀','👅','👅','😩','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','👨','🚀','👩','‍⚖','👨','‍⚖','🤶','🎅','👸','🤴','👰','🤵','👼','🤰','🙇','‍♀','🙇','💁','💁','🙅','🙅','🙆','🏻','🙆','♂','🙋','🙋','🤦','‍♀','🤦','🤷','‍♀','🤷','🙎','🙎','🙍','🙍','💇','💇','💆','💆','😂','😂','😂','😂','😂','😂','😂','😂','👌','✌','💞','👍','👌','💯','👌','💯','👌','💯','👌','💯','🎶','👀','😂','👓','👏','👐','🍕','💥','🍴','💦','💦','💦','💦','🍑','🍆','😩','😏','👉👌','👀','👀','👀','👀','👅','👅','😩','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🕴','💃','🕺','👯','👯','🚶','‍♀','🚶','🏃','‍♀','🏃','👫','👭','👬','💑','👩','‍❤','👩','👨','‍❤','👨','💏','👩','‍❤','💋','👩','👨','‍❤','💋','👨','👪','👨','👩','👧','👨','👩','👧','👦','👨','👩','👦','👦','👨','👩','👧','👧','👩','👩','👦','👩','👩','👧','👦','👩','👩','👦','👩','👩','👦','👦','👩','👩','👧','👧','👨','👨','👦','👨','👨','👧','👨','👨','👧','👦','👨','👨','👦','👦','👨','👨','👧','👧','👩','👦','👩','👧','👩','👧','👦','👩','👦','👦','👩','👧','👧','👨','👦','👨','👧','👨','👧','👦','👨','👦','👦','👨','👧','👧','👚','👕','👖','👔','👗','👙','👘','👠','👡','👢','👞','👟','👒','🎩','🎓','👑','⛑','😂','😂','😂','😂','😂','😂','😂','😂','👌','✌','💞','👍','👌','💯','👌','💯','👌','💯','👌','💯','🎶','👀','😂','👓','👏','👐','🍕','💥','🍴','💦','💦','💦','💦','🍑','🍆','😩','😏','👉👌','👀','👀','👀','👀','👅','👅','😩','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🎒','👝','👛','👜','💼','👓','🕶','🌂','☂','🐶','🐱','🐹','🐭','🐰','🦊','🐻','🐼','🐨','🐯','🦁','🐮','🐷','🐽','🐸','🐵','🙈','🙉','🙊','🐒','🐔','🐧','🐦','🐤','🐣','🐥','🦆','🦅','🦉','🦇','🐺','🐗','🐴','🦄','🐝','🐛','🦋','🐌','🐚','🐞','🐜','🕷','🕸','🐢','🐍','🦎','🦂','🦀','🦑','🐙','🦐','🐠','🐟','🐡','🐬','🦈','🐳','🐋','🐊','🐆','🐅','🐃','🐂','🐄','🦌','🐪','🐫','🐘','🦏','🦍','🐎','🐖','🐐','🐏','🐑','🐕','🐩','🐈','🐓','🦃','🕊','🐇','🐁','🐀','🐿','🐾','🐉','🐲','🌵','🎄','🌲','🌳','🌴','🌱','🌿','☘','🍀','🎍','🎋','🍃','🍂','🍁','🍄','🌾','💐','🌷','🌹','🥀','🌻','🌼','🌸','🌺','🌎','🌍','🌏','🌕','🌖','🌗','🌘','🌑','🌒','🌓','🌔','🌚','🌝','🌞','🌛','🌜','🌙','💫','⭐','🌟','✨⚡','🔥','💥','☄','☀','🌤','⛅','🌥','🌦','🌈','☁','🌧','⛈','🌩','🌨','☃','⛄','❄','🌬','💨','🌪','🌫','🌊','💧','💦','☔','😂','😂','😂','😂','😂','😂','😂','😂','👌','✌','💞','👍','👌','💯','👌','💯','👌','💯','👌','💯','🎶','👀','😂','👓','👏','👐','🍕','💥','🍴','💦','💦','💦','💦','🍑','🍆','😩','😏','👉👌','👀','👀','👀','👀','👅','👅','😩','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🍏','🍎','🍐','🍊','🍋','🍌','🍉','🍇','🍓','🍈','🍒','🍑','🍍','🥝','🥑','🍅','🍆','🥒','🥕','🌽','🌶','🥔','🍠','🌰','🥜','🍯','🥐','🍞','🥖','🧀','🥚','🍳','🥓','🥞','🍤','🍗','🍖','🍕','🌭','🍔','🍟','🥙','🌮','🌯','🥗','🥘','🍝','🍜','🍲','🍥','🍣','🍱','🍛','🍙','🍚','🍘','🍢','🍡','🍧','🍨','🍦','🍰','🎂','🍮','🍭','🍬','🍫','🍿','🍩','🍪','🥛','🍼','☕','🍵','🍶','🍺','🍻','🥂','🍷','🥃','🍸','🍹','🍾','🥄','🍴','🍽','⚽','🏀','🏈','⚾','🎾','🏐','🏉','🎱','🏓','🏸','🥅','🏒','🏑','🏏','⛳','🏹','🎣','🥊','🥋','⛸','🎿','⛷','🏂','🏋','♀','🏋','🤺','🤼','‍♀','🤼','🤸','‍♀','🤸','⛹','♀','⛹','🤾','‍♀','🤾','🏌','♀','🏌','🏄','‍♀','🏄','🏊','‍♀','🏊','🤽','‍♀','🤽','🚣','‍♀','🚣','🏇','🚴','‍♀','🚴','🚵','‍♀','🚵','🎽','🏅','🎖','🥇','🥈','🥉','🏆','🏵','🎗','🎫','🎟','🎪','🤹','‍♀','🤹','🎭','🎨','🎬','🎤','🎧','🎼','🎹','🥁','🎷','🎺','🎸','🎻','🎲','🎯','🎳','🎮','🎰','🚗','🚕','🚙','🚌','🚎','🏎','🚓','🚑','🚒','🚐','🚚','🚛','🚜','🛴','🚲','🛵','🏍','🚨','🚔','🚍','🚘','🚖','🚡','🚠','🚟','🚃','🚋','🚞','🚝','🚄','🚅','🚈','🚂','🚆','🚇','🚊','🚉','🚁','🛩','✈','🛫','🛬','🚀','🛰','💺','🛶','⛵','🛥','🚤','🛳','⛴','🚢','⚓','🚧','⛽','🚏','🚦','🚥','🗺','🗿','🗽','⛲','🗼','🏰','🏯','🏟','🎡','🎢','🎠','⛱','🏖','🏝','⛰','🏔','🗻','🌋','🏜','🏕','⛺','🛤','🛣','🏗','🏭','🏠','🏡','🏘','🏚','🏢','🏬','🏣','🏤','🏥','🏦','🏨','🏪','🏫','🏩','💒','🏛','⛪','🕌','🕍','🕋','⛩','🗾','🎑','🏞','🌅','🌄','🌠','🎇','🎆','🌇','🌆','🏙','🌃','🌌','🌉','🌁','⌚','📱','📲','💻','⌨','🖥','🖨','🖱','🖲','🕹','🗜','💽','💾','💿','📀','📼','📷','📸','📹','🎥','📽','🎞','📞','☎','📟','📠','📺','📻','🎙','🎚','🎛','⏱⏲','⏰','🕰','⌛','⏳','📡','🔋','🔌','💡','🔦','🕯','🗑','🛢','💸','💵','💴','💶','💷','💰','💳','💎','⚖','🔧','🔨','⚒','🛠','⛏','🔩','⚙','⛓','🔫','💣','🔪','🗡','⚔','🛡','🚬','⚰','⚱','🏺','😂','😂','😂','😂','😂','😂','😂','😂','👌','✌','💞','👍','👌','💯','👌','💯','👌','💯','👌','💯','🎶','👀','😂','👓','👏','👐','🍕','💥','🍴','💦','💦','💦','💦','🍑','🍆','😩','😏','👉👌','👀','👀','👀','👀','👅','👅','😩','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🔮','📿','💈','⚗','🔭','🔬','🕳','💊','💉','🌡','🚽','🚰','🚿','🛁','🛀','🛎','🔑','🗝','🚪','🛋','🛏','🛌','🖼','🛍','🛒','🎁','🎈','🎏','🎀','🎊','🎉','🎎','🏮','🎐','✉','📩','📨','📧','💌','📥','📤','📦','🏷','📪','📫','📬','📭','📮','📯','📜','📃','📄','📑','📊','📈','📉','🗒','🗓','📆','📅','📇','🗃','🗳','🗄','📋','📁','📂','🗂','🗞','📰','📓','📔','📒','📕','📗','📘','📙','📚','📖','🔖','🔗','📎','🖇','📐','📏','📌','📍','✂','🖊','🖋','✒','🖌','🖍','📝','✏','🔍','🔎','🔏','🔐','🔓','🔒','❤','💛','💚','💙','💜','🖤','💔','❣','💕','💞','💓','💗','💖','💘','💝','💟','☮','✝','☪','🕉','☸','✡','🔯','🕎','☯','☦','⛎♈','♉','♊','♋','♌','♍','♎','♏','♐','♑','♒','♓','🆔','⚛','🉑','☢','☣','📴','📳','🈶','🈚','🈸','🈺','🈷','✴','🆚','💮','🉐','㊙','㊗','🈴','🈵','🈹','🈲','🅰','🅱','🆎','🆑','🅾','🆘','❌⭕','🛑','⛔','📛','🚫','💯','💢','♨','🚷','🚯','🚳','🚱','🔞','📵','🚭','❗','❕❓','❔‼','⁉','🔅','🔆','〽','⚠','🚸','🔱','⚜','🔰','♻','✅','🈯','💹','❇','✳','❎','🌐','💠','Ⓜ','🌀','💤','🏧','🚾','♿','🅿','🈳','🈂','🛂','🛃','🛄','🛅','🚹','🚺','🚼','🚻','🚮','🎦','📶','🈁','🔣','ℹ','🔤','🔡','🔠','🆖','🆗','🆙','🆒','🆕','🆓','😂','😂','😂','😂','😂','😂','😂','😂','👌','✌','💞','👍','👌','💯','👌','💯','👌','💯','👌','💯','🎶','👀','😂','👓','👏','👐','🍕','💥','🍴','💦','💦','💦','💦','🍑','🍆','😩','😏','👉👌','👀','👀','👀','👀','👅','👅','😩','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🔢','#','⃣*','⃣','▶','⏸⏯','⏹⏺','⏭⏮','⏩⏪','⏫⏬','◀','🔼','🔽','➡','⬅','⬆','⬇','↗','↘','↙','↖','↕','↔','↪','↩','⤴','⤵','🔀','🔁','🔂','🔄','🔃','🎵','🎶','➕➖','➗✖','💲','💱','™©','®〰','➰➿','🔚','🔙','🔛','🔝','🔜','✔','☑','🔘','⚪','⚫','🔴','🔵','🔺','🔻','🔸','🔸','🔹','🔶','🔷','🔳','🔲','▪','▫','◾','◽','◼','◻','⬛','⬜','🔈','🔇','🔉','🔊','🔔','🔕','📣','📢','👁','🗨','💬','💭','🗯','♠','♣','♥','♦','🃏','🎴','🀄','🕐','🕑','🕒','🕓','🕔','🕕','🕖','🕗','🕘','🕙','🕚','🕛','🕜','🕝','🕞','🕟','🕠','🕡','🕢','🕣','🕤','🕥','🕦','🕧','🏳','🏴','🏁','🚩','🏳','🌈','🎌','😂','😂','😂','😂','😂','😂','😂','😂','👌','✌','💞','👍','👌','💯','👌','💯','👌','💯','👌','💯','🎶','👀','😂','👓','👏','👐','🍕','💥','🍴','💦','💦','💦','💦','🍑','🍆','😩','😏','👉👌','👀','👀','👀','👀','👅','👅','😩','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','😂','😂','😂','😂','😂','😂','😂','😂','👌','✌','💞','👍','👌','💯','👌','💯','👌','💯','👌','💯','🎶','👀','😂','👓','👏','👐','🍕','💥','🍴','💦','💦','💦','💦','🍑','🍆','😩','😏','👉👌','👀','👀','👀','👀','👅','👅','😩','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔','🤔',];
	let regex = new RegExp('(c+)', 'gi');
	str = str.replace(regex, "🆑");
	regex = new RegExp('(b+)', 'gi');
	str = str.replace(regex, "🅱️");
	regex = new RegExp('(nigger+|nigga+|nibba+)', 'gi');
	str = str.replace(regex, "ni🅱🅱a️");
	splitBody = str.split(' ');
	for (i = 0; i < splitBody.length; i++) {
		if (splitBody.join(' ').length > limit) break;
		const emojiAmount = Math.floor(Math.random() * 10) + 0;
		for (j = 0; j < emojiAmount; j++) {
			const theEmoji = emoji[Math.floor(Math.random() * emoji.length)];
			splitBody[i] = splitBody[i] + theEmoji;
		}
	}
	str = splitBody.join(' ');
	return str;
}

module.exports = {
	appendFile,
	capitalizeFirstLetter,
	caps,
	commandArgs,
	commandText,
	date,
	deleteFile,
	exists,
	niggerify,
	id,
	rand,
	size,
	stat
};
